<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Steam Finder</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
  <form>
    <label for="searchQuery">Search for a game:</label>
    <input type="text" id="searchQuery" name="searchQuery">
    <button type="submit" id="searchButton">Find a Game</button>
  </form>
  <div id="gameEmbed"></div>
  <script>
    const API_KEY = "196BC42CD26CE964DAB2A98FC1A9F349";

    async function searchSteam(event) {
      event.preventDefault();
      try {
        const steamResponse = await fetch(`https://api.steampowered.com/ISteamApps/GetAppList/v2/?key=${API_KEY}&format=jsonp&callback=parseResponse`, {
          method: 'GET',
          headers: {
            'Content-Type': 'application/json',
          },
        });
        const steamJson = await steamResponse.text();
        eval(steamJson);
      } catch (error) {
        console.error(error);
      }
    }

    function parseResponse(response) {
      const appList = response.applist.apps;
      const searchQuery = $('#searchQuery').val().toLowerCase();
      const matchingApps = appList.filter(app => app.name.toLowerCase().includes(searchQuery));
      if (matchingApps.length > 0) {
        const randomIndex = Math.floor(Math.random() * matchingApps.length);
        const randomApp = matchingApps[randomIndex];
        const appid = randomApp.appid;
        const embedCode = `<iframe src="https://store.steampowered.com/widget/${appid}/" frameborder="0" width="646" height="190"></iframe>`;
        $('#gameEmbed').html(embedCode);
      } else {
        $('#gameEmbed').html('<p>No games found.</p>');
      }
    }

    $(document).ready(function() {
      $('#searchButton').on('click', searchSteam);
    });
  </script>
</body>
</html>
